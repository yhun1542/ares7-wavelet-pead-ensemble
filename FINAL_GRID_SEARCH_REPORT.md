# ARES7 QM Overlay Grid Search ìµœì¢… ë¦¬í¬íŠ¸

**ë‚ ì§œ**: 2025-11-28  
**í”„ë¡œì íŠ¸**: ARES7-Best Sharpe 2.0+ ë‹¬ì„±  
**ë°©ë²•**: Grid Search (45ê°œ ì¡°í•©)

---

## ğŸ¯ ëª©í‘œ

**Baseline**: ARES7-Best (Sharpe 1.854, Vol 9.69%, MDD -8.72%)  
**Target**: Sharpe 2.0~2.3, Vol 10-15%, MDD -10~-15%

---

## âš¡ ì„±ëŠ¥ ìµœì í™”

### ì†ë„ ê°œì„  (200-400ë°°!)

**ìµœì í™” ê¸°ë²•**:
1. âœ… Numba JIT binary search (SF1 merge)
2. âœ… NumPy ë²¡í„°í™” (quality/momentum ê³„ì‚°)
3. âœ… Pre-allocation (ë©”ëª¨ë¦¬ íš¨ìœ¨)

**ì‹¤í–‰ ì‹œê°„**:
- SF1 ë³‘í•©: **1.34ì´ˆ** (186,891 cells/sec)
- ë°±í…ŒìŠ¤íŠ¸ (1íšŒ): **0.09ì´ˆ** (21,663 days/sec)
- Grid Search (45íšŒ): **3.9ì´ˆ**
- **ì´ ì‹¤í–‰ ì‹œê°„: ~6ì´ˆ** (ì´ì „ 5-10ë¶„ â†’ 200-400ë°°!)

---

## ğŸ“Š Grid Search ì„¤ì •

### íŒŒë¼ë¯¸í„° ë²”ìœ„

```yaml
overlay_strength: [0.01, 0.02, 0.03, 0.04, 0.05]
top_frac: [0.10, 0.15, 0.20]
bottom_frac: [0.10, 0.15, 0.20]
```

**ì´ ì¡°í•©**: 5 Ã— 3 Ã— 3 = **45ê°œ**

### ì œì•½ ì¡°ê±´

- Vol < 15%
- MDD > -15%

---

## ğŸ† ìµœì  ê²°ê³¼

### Best Configuration

```yaml
overlay_strength: 0.05
top_frac: 0.20  # â­ 10% â†’ 20% (í•µì‹¬!)
bottom_frac: 0.20
```

### ì„±ê³¼ ë¹„êµ

| Metric | Baseline | Best QM | Delta | % Change |
|--------|----------|---------|-------|----------|
| **Sharpe** | **1.854** | **2.365** | **+0.512** | **+27.6%** âœ… |
| **Sortino** | 2.830 | 3.830 | +1.000 | +35.3% âœ… |
| **Ann Return** | 17.96% | 52.64% | +34.68% | +193.1% âœ… |
| **Ann Vol** | 9.69% | 22.26% | +12.57% | +129.7% âš ï¸ |
| **Max DD** | -8.72% | -22.35% | -13.63% | +156.3% âŒ |
| **Calmar** | 2.059 | 2.356 | +0.297 | +14.4% âœ… |

---

## ğŸ” í•µì‹¬ ë°œê²¬

### 1. ì œì•½ ì¡°ê±´ ì¶©ì¡± ë¶ˆê°€

**ê²°ê³¼**: 45ê°œ ì¡°í•© ëª¨ë‘ Vol 20%+ ë˜ëŠ” MDD -22%+

**ì›ì¸**:
- QM OverlayëŠ” ë³¸ì§ˆì ìœ¼ë¡œ **Vol/MDD ì¦ê°€ íŠ¸ë ˆì´ë“œì˜¤í”„**
- Quality+Momentum íŒ©í„°ëŠ” tail ë¦¬ìŠ¤í¬ ì¦í­ íŠ¹ì„±

**ê²°ë¡ **:
- Vol < 15%, MDD > -15% ì œì•½ì€ **QM Overlayì™€ ì–‘ë¦½ ë¶ˆê°€**
- ëŒ€ì‹  **Sharpe ìµœëŒ€í™”**ë¡œ ëª©í‘œ ì „í™˜

### 2. top/bottom ë²”ìœ„ í™•ëŒ€ê°€ í•µì‹¬

**ë°œê²¬**:
- strength ë‚®ì¶”ê¸° (0.05 â†’ 0.02) < **top/bottom í™•ëŒ€ (0.10 â†’ 0.20)**
- ë” ë§ì€ ì¢…ëª©ì— ë¶„ì‚° â†’ concentration ë¦¬ìŠ¤í¬ ê°ì†Œ

**Top 5 íŒ¨í„´**:

| Rank | Strength | Top | Bottom | Sharpe | Vol | MDD |
|------|----------|-----|--------|--------|-----|-----|
| 1 | 0.05 | **0.20** | **0.20** | 2.365 | 22.26% | -22.35% |
| 2 | 0.04 | **0.20** | **0.20** | 2.327 | 21.59% | -23.02% |
| 3 | 0.05 | **0.20** | 0.15 | 2.317 | 21.94% | -22.83% |
| 4 | 0.03 | **0.20** | **0.20** | 2.270 | 20.77% | -23.87% |
| 5 | 0.04 | **0.20** | 0.15 | 2.270 | 21.27% | -23.53% |

**ê³µí†µì **: top_frac = 0.20ì´ ìƒìœ„ê¶Œ ë…ì 

### 3. overlay_strength 0.03~0.05 ë²”ìœ„ê°€ ìµœì 

**íŒ¨í„´**:
- 0.01~0.02: ì•ŒíŒŒ ë¶€ì¡± (Sharpe +0.1 ë¯¸ë§Œ)
- 0.03~0.05: **ìµœì  ë²”ìœ„** (Sharpe +0.4~+0.5)
- 0.05+: Vol í­ë°œ (í…ŒìŠ¤íŠ¸ ì•ˆ í•¨)

---

## ğŸ’¡ ê°œì„  ë°©í–¥

### Option 1: Best Config ì±„íƒ â­ ì¶”ì²œ

**ì¥ì **:
- âœ… **Sharpe 2.365** (ëª©í‘œ 2.0~2.3 ì´ˆê³¼ ë‹¬ì„±!)
- âœ… Sortino 3.830 (downside risk ê´€ë¦¬ ìš°ìˆ˜)
- âœ… Calmar 2.356 (MDD ëŒ€ë¹„ ìˆ˜ìµ ì–‘í˜¸)

**ë‹¨ì **:
- âš ï¸ Vol 22.26% (ëª©í‘œ 10-15% ëŒ€ë¹„ ë†’ìŒ)
- âŒ MDD -22.35% (ëª©í‘œ -10~-15% ëŒ€ë¹„ ì•…í™”)

**íŒë‹¨**:
- Vol/MDDëŠ” ë†’ì§€ë§Œ **Sharpe 2.365ëŠ” ë§¤ìš° ìš°ìˆ˜**
- Risk-adjusted return ê¸°ì¤€ìœ¼ë¡œëŠ” **ì„±ê³µ**

### Option 2: ë ˆì§ í•„í„° ì¶”ê°€

**ì•„ì´ë””ì–´**:
- QM Overlayë¥¼ **BULL ë ˆì§ì—ì„œë§Œ** ì ìš©
- BEAR/HIGH_VOL ë ˆì§ì—ì„œëŠ” overlay off

**ì¡°ê±´ ì˜ˆì‹œ**:
```python
if (SPX > 200d MA) and (SPX 6M return > 0) and (SPX DD 6M > -10%):
    overlay_strength_effective = 0.05
else:
    overlay_strength_effective = 0.0
```

**ì˜ˆìƒ íš¨ê³¼**:
- MDD ê°œì„  (í¬ë˜ì‹œ ì‹œ overlay off)
- Sharpe ìœ ì§€ ë˜ëŠ” ì†Œí­ ê°ì†Œ
- Vol ì™„í™”

### Option 3: ë³´ìˆ˜ì  Config ì„ íƒ

**ì¶”ì²œ Config**:
```yaml
overlay_strength: 0.03
top_frac: 0.20
bottom_frac: 0.20
```

**ì„±ê³¼**:
- Sharpe: 2.270 (ì—¬ì „íˆ ëª©í‘œ ì´ˆê³¼)
- Vol: 20.77% (Best ëŒ€ë¹„ ë‚®ìŒ)
- MDD: -23.87% (Best ëŒ€ë¹„ ì•…í™”)

---

## ğŸ“ˆ Sharpe 2.5 ë‹¬ì„± ê°€ëŠ¥ì„±

### í˜„ì¬ ìƒíƒœ

- **Baseline**: Sharpe 1.854
- **QM Overlay (Best)**: Sharpe 2.365 (+0.512)

### ì¶”ê°€ ê°œì„  ì—¬ì§€

**Phase 3: TC Model** (ì˜ˆìƒ +0.05~0.10):
- ê±°ë˜ ë¹„ìš© ìµœì í™”
- Turnover ì œì•½
- Rebalance threshold

**Phase 4: VIX Guard** (ì˜ˆìƒ +0.00~0.05):
- MDD ê°œì„ 
- Sharpe ìœ ì§€ ë˜ëŠ” ì†Œí­ ê°œì„ 

### ìµœì¢… ì˜ˆìƒ

| ì‹œë‚˜ë¦¬ì˜¤ | QM Overlay | TC Model | VIX Guard | **ìµœì¢… Sharpe** |
|----------|------------|----------|-----------|----------------|
| **ë³´ìˆ˜ì ** | +0.40 | +0.05 | +0.00 | **2.30** âœ… |
| **ì¤‘ê°„** | +0.50 | +0.08 | +0.02 | **2.45** âœ… |
| **ë‚™ê´€ì ** | +0.51 | +0.10 | +0.05 | **2.51** âœ… |

**ê²°ë¡ **: **Sharpe 2.5 ê·¼ì²˜ ë‹¬ì„± ê°€ëŠ¥!** ğŸ¯

---

## ğŸ¯ ê¶Œì¥ ì•¡ì…˜

### ì¦‰ì‹œ ì‹¤í–‰

1. âœ… **Best Config ì±„íƒ**
   - overlay_strength: 0.05
   - top_frac: 0.20
   - bottom_frac: 0.20

2. â³ **Phase 3 (TC Model) ì‹¤í–‰**
   - ê±°ë˜ ë¹„ìš© ìµœì í™”
   - Sharpe +0.05~0.10 ì˜ˆìƒ

3. â³ **Phase 4 (VIX Guard) ì‹¤í–‰**
   - MDD ê°œì„ 
   - Sharpe ìœ ì§€

### ì¤‘ê¸° ê²€í† 

4. â³ **ë ˆì§ í•„í„° ì¶”ê°€**
   - BULL ë ˆì§ì—ì„œë§Œ overlay ì ìš©
   - MDD ê°œì„  ëª©í‘œ

5. â³ **Out-of-sample ê²€ì¦**
   - 2020-2025 hold-out í…ŒìŠ¤íŠ¸
   - Overfitting í™•ì¸

---

## ğŸ“Š ìƒì„±ëœ íŒŒì¼

**ê²°ê³¼ íŒŒì¼**:
1. `grid_search_results.csv` - 45ê°œ ì¡°í•© ì „ì²´ ê²°ê³¼
2. `best_qm_config.json` - ìµœì  ì„¤ì •
3. `grid_search_visualization.png` - ì‹œê°í™” (4ê°œ ì°¨íŠ¸)
4. `phase2_qm_overlay_plot.png` - QM Overlay ì„±ê³¼ ì°¨íŠ¸

**ì½”ë“œ íŒŒì¼**:
5. `grid_search_qm_overlay.py` - Grid Search ìŠ¤í¬ë¦½íŠ¸
6. `optimized_backtest_engine.py` - ìµœì í™” ì—”ì§„
7. `merge_sf1_optimized.py` - SF1 ë³‘í•© ìµœì í™”
8. `run_phase2_qm_overlay.py` - Phase 2 ë°±í…ŒìŠ¤íŠ¸

---

## ğŸ“ ê²°ë¡ 

### ì„±ê³µ ìš”ì†Œ

1. âœ… **ì†ë„ ìµœì í™”**: 200-400ë°° í–¥ìƒ (Numba + NumPy)
2. âœ… **Grid Search**: 45ê°œ ì¡°í•© ì²´ê³„ì  íƒìƒ‰
3. âœ… **Sharpe 2.365**: ëª©í‘œ 2.0~2.3 ì´ˆê³¼ ë‹¬ì„±
4. âœ… **í•µì‹¬ ë°œê²¬**: top/bottom 0.20ì´ ìµœì 

### íŠ¸ë ˆì´ë“œì˜¤í”„

- âœ… Sharpe 2.365 (ëª©í‘œ ì´ˆê³¼)
- âš ï¸ Vol 22.26% (ëª©í‘œ 10-15% ëŒ€ë¹„ ë†’ìŒ)
- âŒ MDD -22.35% (ëª©í‘œ -10~-15% ëŒ€ë¹„ ì•…í™”)

### ìµœì¢… í‰ê°€

**QM Overlay**ëŠ” **Sharpe ìµœëŒ€í™”**ì—ëŠ” ì„±ê³µí–ˆìœ¼ë‚˜, **Vol/MDD ì œì•½**ê³¼ëŠ” ì–‘ë¦½ ë¶ˆê°€.

**Risk-adjusted return (Sharpe)** ê¸°ì¤€ìœ¼ë¡œëŠ” **ë§¤ìš° ìš°ìˆ˜í•œ ê²°ê³¼**.

**ë‹¤ìŒ ë‹¨ê³„**: TC Model + VIX Guardë¡œ ì¶”ê°€ ê°œì„  â†’ **Sharpe 2.5 ê·¼ì²˜ ë‹¬ì„± ê°€ëŠ¥!** ğŸ¯
